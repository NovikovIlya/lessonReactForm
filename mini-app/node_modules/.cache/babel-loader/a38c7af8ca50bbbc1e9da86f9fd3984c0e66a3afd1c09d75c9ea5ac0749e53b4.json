{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"className\", \"style\", \"before\", \"inlineAfter\", \"after\", \"getRootRef\", \"getRef\", \"onHeightChange\", \"shadow\", \"defaultValue\"];\nimport * as React from 'react';\nimport { Headline } from '../Typography/Headline/Headline';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { classNames, hasReactNode } from '@vkontakte/vkjs';\nimport { Platform } from '../../lib/platform';\nimport { useEnsuredControl } from '../../hooks/useEnsuredControl';\n/**\n * @see https://vkcom.github.io/VKUI/#/WriteBar\n */\nexport var WriteBar = function WriteBar(_ref) {\n  var className = _ref.className,\n    style = _ref.style,\n    before = _ref.before,\n    inlineAfter = _ref.inlineAfter,\n    after = _ref.after,\n    getRootRef = _ref.getRootRef,\n    getRef = _ref.getRef,\n    onHeightChange = _ref.onHeightChange,\n    _ref$shadow = _ref.shadow,\n    shadow = _ref$shadow === void 0 ? false : _ref$shadow,\n    defaultValue = _ref.defaultValue,\n    restProps = _objectWithoutProperties(_ref, _excluded);\n  var platform = usePlatform();\n  var _useEnsuredControl = useEnsuredControl(_objectSpread({\n      defaultValue: defaultValue\n    }, restProps)),\n    _useEnsuredControl2 = _slicedToArray(_useEnsuredControl, 2),\n    value = _useEnsuredControl2[0],\n    onChange = _useEnsuredControl2[1];\n  var textareaRef = useExternRef(getRef);\n  var currentScrollHeight = React.useRef();\n  var resize = React.useCallback(function () {\n    var textareaEl = textareaRef.current;\n    if (!textareaEl) {\n      return;\n    }\n    if (textareaEl.offsetParent) {\n      textareaEl.style.height = '';\n      textareaEl.style.height = \"\".concat(textareaEl.scrollHeight, \"px\");\n      if (textareaEl.scrollHeight !== currentScrollHeight.current && onHeightChange) {\n        onHeightChange();\n        currentScrollHeight.current = textareaEl.scrollHeight;\n      }\n    }\n  }, [onHeightChange, textareaRef]);\n  React.useEffect(resize, [resize, value]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: getRootRef,\n    className: classNames(\"vkuiWriteBar\", platform === Platform.IOS && \"vkuiWriteBar--ios\", shadow && \"vkuiWriteBar--shadow\", className),\n    style: style\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiWriteBar__form\"\n  }, hasReactNode(before) && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiWriteBar__before\"\n  }, before), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiWriteBar__formIn\"\n  }, /*#__PURE__*/React.createElement(Headline, _extends({}, restProps, {\n    Component: \"textarea\",\n    className: \"vkuiWriteBar__textarea\",\n    onChange: onChange,\n    getRootRef: textareaRef,\n    value: value\n  })), hasReactNode(inlineAfter) && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiWriteBar__inlineAfter\"\n  }, inlineAfter)), hasReactNode(after) && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiWriteBar__after\"\n  }, after)));\n};","map":{"version":3,"names":["React","Headline","usePlatform","useExternRef","classNames","hasReactNode","Platform","useEnsuredControl","WriteBar","_ref","className","style","before","inlineAfter","after","getRootRef","getRef","onHeightChange","_ref$shadow","shadow","defaultValue","restProps","_objectWithoutProperties","_excluded","platform","_useEnsuredControl","_objectSpread","_useEnsuredControl2","_slicedToArray","value","onChange","textareaRef","currentScrollHeight","useRef","resize","useCallback","textareaEl","current","offsetParent","height","concat","scrollHeight","useEffect","createElement","ref","IOS","_extends","Component"],"sources":["E:\\lessonReactForm\\mini-app\\node_modules\\@vkontakte\\vkui\\src\\components\\WriteBar\\WriteBar.tsx"],"sourcesContent":["import * as React from 'react';\nimport { Headline } from '../Typography/Headline/Headline';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useExternRef } from '../../hooks/useExternRef';\nimport { classNames, hasReactNode } from '@vkontakte/vkjs';\nimport { Platform } from '../../lib/platform';\nimport { HasRef, HasRootRef } from '../../types';\nimport { useEnsuredControl } from '../../hooks/useEnsuredControl';\nimport styles from './WriteBar.module.css';\n\nexport interface WriteBarProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement>,\n    HasRootRef<HTMLDivElement>,\n    HasRef<HTMLTextAreaElement> {\n  /**\n   * Содержимое, отображаемое слева от поля ввода.\n   */\n  before?: React.ReactNode;\n  /**\n   * Содержимое, отображаемое поверх поля ввода (актуально для iOS)\n   */\n  inlineAfter?: React.ReactNode;\n  /**\n   * Содержимое, отображаемое справа от поля ввода\n   */\n  after?: React.ReactNode;\n  /**\n   * Вызывается при смене высоты поля ввода\n   */\n  onHeightChange?: VoidFunction;\n  /**\n   * Добавляет тень вокруг поля ввода\n   */\n  shadow?: boolean;\n\n  children?: never;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/WriteBar\n */\nexport const WriteBar = ({\n  className,\n  style,\n  before,\n  inlineAfter,\n  after,\n  getRootRef,\n  getRef,\n  onHeightChange,\n  shadow = false,\n  defaultValue,\n  ...restProps\n}: WriteBarProps) => {\n  const platform = usePlatform();\n\n  const [value, onChange] = useEnsuredControl({\n    defaultValue,\n    ...restProps,\n  });\n\n  const textareaRef = useExternRef(getRef);\n  const currentScrollHeight = React.useRef<number>();\n\n  const resize = React.useCallback(() => {\n    const textareaEl = textareaRef.current;\n    if (!textareaEl) {\n      return;\n    }\n\n    if (textareaEl.offsetParent) {\n      textareaEl.style.height = '';\n      textareaEl.style.height = `${textareaEl.scrollHeight}px`;\n\n      if (textareaEl.scrollHeight !== currentScrollHeight.current && onHeightChange) {\n        onHeightChange();\n        currentScrollHeight.current = textareaEl.scrollHeight;\n      }\n    }\n  }, [onHeightChange, textareaRef]);\n\n  React.useEffect(resize, [resize, value]);\n\n  return (\n    <div\n      ref={getRootRef}\n      className={classNames(\n        styles['WriteBar'],\n        platform === Platform.IOS && styles['WriteBar--ios'],\n        shadow && styles['WriteBar--shadow'],\n        className,\n      )}\n      style={style}\n    >\n      <div className={styles['WriteBar__form']}>\n        {hasReactNode(before) && <div className={styles['WriteBar__before']}>{before}</div>}\n\n        <div className={styles['WriteBar__formIn']}>\n          <Headline\n            {...restProps}\n            Component=\"textarea\"\n            className={styles['WriteBar__textarea']}\n            onChange={onChange}\n            getRootRef={textareaRef}\n            value={value}\n          />\n          {hasReactNode(inlineAfter) && (\n            <div className={styles['WriteBar__inlineAfter']}>{inlineAfter}</div>\n          )}\n        </div>\n\n        {hasReactNode(after) && <div className={styles['WriteBar__after']}>{after}</div>}\n      </div>\n    </div>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
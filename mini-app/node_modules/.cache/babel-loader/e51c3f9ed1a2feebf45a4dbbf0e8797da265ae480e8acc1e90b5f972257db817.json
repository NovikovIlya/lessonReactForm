{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"initialSlideIndex\", \"children\", \"timeout\", \"onChange\", \"bullets\"];\nimport * as React from 'react';\nimport { clamp } from '../../helpers/math';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { BaseGallery } from '../BaseGallery/BaseGallery';\n/**\n * @see https://vkcom.github.io/VKUI/#/Gallery\n */\nexport var Gallery = function Gallery(_ref) {\n  var _props$slideIndex;\n  var _ref$initialSlideInde = _ref.initialSlideIndex,\n    initialSlideIndex = _ref$initialSlideInde === void 0 ? 0 : _ref$initialSlideInde,\n    children = _ref.children,\n    _ref$timeout = _ref.timeout,\n    timeout = _ref$timeout === void 0 ? 0 : _ref$timeout,\n    onChange = _ref.onChange,\n    bullets = _ref.bullets,\n    props = _objectWithoutProperties(_ref, _excluded);\n  var _React$useState = React.useState(initialSlideIndex),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    localSlideIndex = _React$useState2[0],\n    setSlideIndex = _React$useState2[1];\n  var isControlled = typeof props.slideIndex === 'number';\n  var slideIndex = isControlled ? (_props$slideIndex = props.slideIndex) !== null && _props$slideIndex !== void 0 ? _props$slideIndex : 0 : localSlideIndex;\n  var isDraggable = !isControlled || Boolean(onChange);\n  var slides = React.useMemo(function () {\n    return React.Children.toArray(children).filter(function (item) {\n      return Boolean(item);\n    });\n  }, [children]);\n  var childCount = slides.length;\n  var handleChange = React.useCallback(function (current) {\n    if (current === slideIndex) {\n      return;\n    }\n    !isControlled && setSlideIndex(current);\n    onChange && onChange(current);\n  }, [isControlled, onChange, slideIndex]);\n  var autoplay = useTimeout(function () {\n    return handleChange((slideIndex + 1) % childCount);\n  }, timeout);\n  React.useEffect(function () {\n    return timeout ? autoplay.set() : autoplay.clear();\n  }, [timeout, slideIndex, autoplay]);\n\n  // prevent invalid slideIndex\n  // any slide index is invalid with no slides, just keep it as is\n  var safeSlideIndex = childCount > 0 ? clamp(slideIndex, 0, childCount - 1) : slideIndex;\n  // notify parent in controlled mode\n  React.useEffect(function () {\n    if (onChange && safeSlideIndex !== slideIndex) {\n      onChange(safeSlideIndex);\n    }\n    setSlideIndex(safeSlideIndex);\n  }, [onChange, safeSlideIndex, slideIndex]);\n  return /*#__PURE__*/React.createElement(BaseGallery, _extends({\n    isDraggable: isDraggable\n  }, props, {\n    bullets: childCount > 0 && bullets,\n    slideIndex: safeSlideIndex,\n    onChange: handleChange\n  }), slides);\n};","map":{"version":3,"names":["React","clamp","useTimeout","BaseGallery","Gallery","_ref","_props$slideIndex","_ref$initialSlideInde","initialSlideIndex","children","_ref$timeout","timeout","onChange","bullets","props","_objectWithoutProperties","_excluded","_React$useState","useState","_React$useState2","_slicedToArray","localSlideIndex","setSlideIndex","isControlled","slideIndex","isDraggable","Boolean","slides","useMemo","Children","toArray","filter","item","childCount","length","handleChange","useCallback","current","autoplay","useEffect","set","clear","safeSlideIndex","createElement","_extends"],"sources":["E:\\lessonReactForm\\mini-app\\node_modules\\@vkontakte\\vkui\\src\\components\\Gallery\\Gallery.tsx"],"sourcesContent":["import * as React from 'react';\nimport { clamp } from '../../helpers/math';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { BaseGallery } from '../BaseGallery/BaseGallery';\nimport { BaseGalleryProps } from '../BaseGallery/types';\n\nexport interface GalleryProps extends BaseGalleryProps {\n  initialSlideIndex?: number;\n  timeout?: number;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/Gallery\n */\nexport const Gallery = ({\n  initialSlideIndex = 0,\n  children,\n  timeout = 0,\n  onChange,\n  bullets,\n  ...props\n}: GalleryProps) => {\n  const [localSlideIndex, setSlideIndex] = React.useState(initialSlideIndex);\n  const isControlled = typeof props.slideIndex === 'number';\n  const slideIndex = isControlled ? props.slideIndex ?? 0 : localSlideIndex;\n  const isDraggable = !isControlled || Boolean(onChange);\n  const slides = React.useMemo(\n    () => React.Children.toArray(children).filter((item) => Boolean(item)),\n    [children],\n  );\n  const childCount = slides.length;\n\n  const handleChange: GalleryProps['onChange'] = React.useCallback(\n    (current: number) => {\n      if (current === slideIndex) {\n        return;\n      }\n      !isControlled && setSlideIndex(current);\n      onChange && onChange(current);\n    },\n    [isControlled, onChange, slideIndex],\n  );\n\n  const autoplay = useTimeout(() => handleChange((slideIndex + 1) % childCount), timeout);\n  React.useEffect(\n    () => (timeout ? autoplay.set() : autoplay.clear()),\n    [timeout, slideIndex, autoplay],\n  );\n\n  // prevent invalid slideIndex\n  // any slide index is invalid with no slides, just keep it as is\n  const safeSlideIndex = childCount > 0 ? clamp(slideIndex, 0, childCount - 1) : slideIndex;\n  // notify parent in controlled mode\n  React.useEffect(() => {\n    if (onChange && safeSlideIndex !== slideIndex) {\n      onChange(safeSlideIndex);\n    }\n    setSlideIndex(safeSlideIndex);\n  }, [onChange, safeSlideIndex, slideIndex]);\n\n  return (\n    <BaseGallery\n      isDraggable={isDraggable}\n      {...props}\n      bullets={childCount > 0 && bullets}\n      slideIndex={safeSlideIndex}\n      onChange={handleChange}\n    >\n      {slides}\n    </BaseGallery>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"children\", \"onClose\", \"opened\", \"className\"];\nimport * as React from 'react';\nimport { FixedLayout } from '../FixedLayout/FixedLayout';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useDOM } from '../../lib/dom';\nimport { Platform } from '../../lib/platform';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { useGlobalEventListener } from '../../hooks/useGlobalEventListener';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useScrollLock } from '../AppRoot/ScrollContext';\nimport { getSizeXClassName } from '../../helpers/getSizeXClassName';\n/**\n * @see https://vkcom.github.io/VKUI/#/PanelHeaderContext\n */\nexport var PanelHeaderContext = function PanelHeaderContext(_ref) {\n  var children = _ref.children,\n    onClose = _ref.onClose,\n    _ref$opened = _ref.opened,\n    opened = _ref$opened === void 0 ? false : _ref$opened,\n    className = _ref.className,\n    restProps = _objectWithoutProperties(_ref, _excluded);\n  var _useDOM = useDOM(),\n    document = _useDOM.document;\n  var platform = usePlatform();\n  var _React$useState = React.useState(opened),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    visible = _React$useState2[0],\n    setVisible = _React$useState2[1];\n  var closing = visible && !opened;\n  var _useAdaptivity = useAdaptivity(),\n    sizeX = _useAdaptivity.sizeX;\n  var elementRef = React.useRef(null);\n  useIsomorphicLayoutEffect(function () {\n    opened && setVisible(true);\n  }, [opened]);\n  useScrollLock(platform !== Platform.VKCOM && opened);\n\n  // start closing on outer click\n  useGlobalEventListener(document, 'click', opened && !closing && function (event) {\n    if (elementRef.current && !elementRef.current.contains(event.target)) {\n      event.stopPropagation();\n      onClose();\n    }\n  }, {\n    capture: true\n  });\n\n  // fallback onAnimationEnd when animationend not supported\n  var onAnimationEnd = function onAnimationEnd() {\n    return setVisible(false);\n  };\n  var animationFallback = useTimeout(onAnimationEnd, 200);\n  React.useEffect(function () {\n    return closing ? animationFallback.set() : animationFallback.clear();\n  }, [animationFallback, closing]);\n  return /*#__PURE__*/React.createElement(FixedLayout, _extends({}, restProps, {\n    className: classNames(\"vkuiPanelHeaderContext\", platform === Platform.IOS && \"vkuiPanelHeaderContext--ios\", opened && \"vkuiPanelHeaderContext--opened\", closing && \"vkuiPanelHeaderContext--closing\", getSizeXClassName(\"vkuiPanelHeaderContext\", sizeX), \"vkuiPanelHeaderContext--rounded\", className),\n    vertical: \"top\"\n  }), visible && /*#__PURE__*/React.createElement(\"div\", {\n    onClick: function onClick(event) {\n      event.stopPropagation();\n      onClose();\n    },\n    className: \"vkuiPanelHeaderContext__fade\"\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiPanelHeaderContext__in\",\n    ref: elementRef,\n    onAnimationEnd: closing ? onAnimationEnd : undefined\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"vkuiPanelHeaderContext__content\"\n  }, visible && children)));\n};","map":{"version":3,"names":["React","FixedLayout","classNames","useAdaptivity","useDOM","Platform","useIsomorphicLayoutEffect","useGlobalEventListener","useTimeout","usePlatform","useScrollLock","getSizeXClassName","PanelHeaderContext","_ref","children","onClose","_ref$opened","opened","className","restProps","_objectWithoutProperties","_excluded","_useDOM","document","platform","_React$useState","useState","_React$useState2","_slicedToArray","visible","setVisible","closing","_useAdaptivity","sizeX","elementRef","useRef","VKCOM","event","current","contains","target","stopPropagation","capture","onAnimationEnd","animationFallback","useEffect","set","clear","createElement","_extends","IOS","vertical","onClick","ref","undefined"],"sources":["E:\\lessonReactForm\\mini-app\\node_modules\\@vkontakte\\vkui\\src\\components\\PanelHeaderContext\\PanelHeaderContext.tsx"],"sourcesContent":["import * as React from 'react';\nimport { FixedLayout } from '../FixedLayout/FixedLayout';\nimport { classNames } from '@vkontakte/vkjs';\nimport { useAdaptivity } from '../../hooks/useAdaptivity';\nimport { useDOM } from '../../lib/dom';\nimport { Platform } from '../../lib/platform';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { useGlobalEventListener } from '../../hooks/useGlobalEventListener';\nimport { useTimeout } from '../../hooks/useTimeout';\nimport { usePlatform } from '../../hooks/usePlatform';\nimport { useScrollLock } from '../AppRoot/ScrollContext';\nimport { getSizeXClassName } from '../../helpers/getSizeXClassName';\nimport styles from './PanelHeaderContext.module.css';\n\nexport interface PanelHeaderContextProps extends React.HTMLAttributes<HTMLDivElement> {\n  opened: boolean;\n  onClose: VoidFunction;\n}\n\n/**\n * @see https://vkcom.github.io/VKUI/#/PanelHeaderContext\n */\nexport const PanelHeaderContext = ({\n  children,\n  onClose,\n  opened = false,\n  className,\n  ...restProps\n}: PanelHeaderContextProps) => {\n  const { document } = useDOM();\n  const platform = usePlatform();\n  const [visible, setVisible] = React.useState(opened);\n  const closing = visible && !opened;\n  const { sizeX } = useAdaptivity();\n  const elementRef = React.useRef<HTMLDivElement>(null);\n\n  useIsomorphicLayoutEffect(() => {\n    opened && setVisible(true);\n  }, [opened]);\n\n  useScrollLock(platform !== Platform.VKCOM && opened);\n\n  // start closing on outer click\n  useGlobalEventListener(\n    document,\n    'click',\n    opened &&\n      !closing &&\n      ((event) => {\n        if (elementRef.current && !elementRef.current.contains(event.target as Node)) {\n          event.stopPropagation();\n          onClose();\n        }\n      }),\n    { capture: true },\n  );\n\n  // fallback onAnimationEnd when animationend not supported\n  const onAnimationEnd = () => setVisible(false);\n  const animationFallback = useTimeout(onAnimationEnd, 200);\n  React.useEffect(\n    () => (closing ? animationFallback.set() : animationFallback.clear()),\n    [animationFallback, closing],\n  );\n\n  return (\n    <FixedLayout\n      {...restProps}\n      className={classNames(\n        styles['PanelHeaderContext'],\n        platform === Platform.IOS && styles['PanelHeaderContext--ios'],\n        opened && styles['PanelHeaderContext--opened'],\n        closing && styles['PanelHeaderContext--closing'],\n        getSizeXClassName(styles['PanelHeaderContext'], sizeX),\n        styles['PanelHeaderContext--rounded'],\n        className,\n      )}\n      vertical=\"top\"\n    >\n      {visible && (\n        <div\n          onClick={(event) => {\n            event.stopPropagation();\n            onClose();\n          }}\n          className={styles['PanelHeaderContext__fade']}\n        />\n      )}\n      <div\n        className={styles['PanelHeaderContext__in']}\n        ref={elementRef}\n        onAnimationEnd={closing ? onAnimationEnd : undefined}\n      >\n        <div className={styles['PanelHeaderContext__content']}>{visible && children}</div>\n      </div>\n    </FixedLayout>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport * as React from 'react';\nimport { canUseDOM, hasMouse as hasPointerLib, hasHover as hasHoverLib } from '@vkontakte/vkjs';\nimport { AdaptivityContext } from '../components/AdaptivityProvider/AdaptivityContext';\nimport { getOrDefault } from '../helpers/getOrDefault';\nimport { getViewWidthByMediaQueries, getViewHeightByMediaQueries, getSizeX, getSizeY, tryToCheckIsDesktop } from '../lib/adaptivity';\nimport { useMediaQueries } from './useMediaQueries';\nimport { usePlatform } from './usePlatform';\nimport { matchMediaListAddListener, matchMediaListRemoveListener } from '../lib/matchMedia';\n/**\n * Высчитывает и возвращает параметры адаптивности при изменении вьюпорта.\n *\n * Берёт в приоритет значения из `AdaptivityContext`.\n *\n * > ⚠ SSR\n * >\n * > Во избежания ошибок при гидратации, не используйте данный хук, если есть вероятность, что компонент будет отрендерен\n * > на стороне сервера.\n * >\n * > Лучше всего использовать для всплывающих окон, т.к. они вызываются только после загрузки\n * > страницы либо пользователем, либо программно.\n */\nexport var useAdaptivityWithJSMediaQueries = function useAdaptivityWithJSMediaQueries() {\n  if (!canUseDOM) {\n    console.error(\"[useAdaptivityWithJSMediaQueries] \\u041F\\u043E\\u0445\\u043E\\u0436\\u0435, \\u0432\\u044B \\u043F\\u044B\\u0442\\u0430\\u0435\\u0442\\u0435\\u0441\\u044C \\u0438\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u044C \\u0445\\u0443\\u043A \\u0432\\u043D\\u0435 \\u0431\\u0440\\u0430\\u0443\\u0437\\u0435\\u0440\\u0430.\\n\\n\\u041F\\u043E\\u0441\\u0442\\u0430\\u0440\\u0430\\u0439\\u0442\\u0435\\u0441\\u044C \\u044D\\u0442\\u043E\\u0433\\u043E \\u0438\\u0437\\u0431\\u0435\\u0433\\u0430\\u0442\\u044C, \\u0447\\u0442\\u043E\\u0431\\u044B \\u043D\\u0435 \\u0431\\u044B\\u043B\\u043E \\u043E\\u0448\\u0438\\u0431\\u043E\\u043A \\u043F\\u0440\\u0438 \\u0433\\u0438\\u0434\\u0440\\u0430\\u0442\\u0430\\u0446\\u0438\\u0438: \\u043F\\u0440\\u0438 SSR \\u043D\\u0435\\u0442 \\u0438\\u043D\\u0444\\u043E\\u0440\\u043C\\u0430\\u0446\\u0438\\u0438 \\u043E \\u0440\\u0430\\u0437\\u043C\\u0435\\u0440\\u0430\\u0445 \\u044D\\u043A\\u0440\\u0430\\u043D\\u0430.\\n\\n\\u0418\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u0443\\u0439\\u0442\\u0435 CSS Media Query \\u0438\\u043B\\u0438 \\u0431\\u0438\\u0431\\u043B\\u0438\\u043E\\u0442\\u0435\\u043A\\u0443 \\u043F\\u043E \\u0442\\u0438\\u043F\\u0443 https://github.com/artsy/fresnel.\");\n  }\n  var _React$useContext = React.useContext(AdaptivityContext),\n    viewWidthContext = _React$useContext.viewWidth,\n    viewHeightContext = _React$useContext.viewHeight,\n    sizeXContext = _React$useContext.sizeX,\n    sizeYContext = _React$useContext.sizeY,\n    hasPointerContext = _React$useContext.hasPointer,\n    hasHoverContext = _React$useContext.hasHover;\n  var platform = usePlatform();\n  var mediaQueries = useMediaQueries();\n  var _React$useState = React.useState(function () {\n      return [getOrDefault(viewWidthContext, getViewWidthByMediaQueries(mediaQueries)), getOrDefault(viewHeightContext, getViewHeightByMediaQueries(mediaQueries))];\n    }),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    _React$useState2$ = _slicedToArray(_React$useState2[0], 2),\n    viewWidthLocal = _React$useState2$[0],\n    viewHeightLocal = _React$useState2$[1],\n    setViewSizeLocal = _React$useState2[1];\n  var adaptivityProps = React.useMemo(function () {\n    var hasPointer = getOrDefault(hasPointerContext, hasPointerLib);\n    var hasHover = getOrDefault(hasHoverContext, hasHoverLib);\n    var viewWidth = getOrDefault(viewWidthContext, viewWidthLocal);\n    var viewHeight = getOrDefault(viewHeightContext, viewHeightLocal);\n    var sizeX = getOrDefault(sizeXContext, getSizeX(viewWidth));\n    var sizeY = getOrDefault(sizeYContext, getSizeY(viewWidth, viewHeight, hasPointer));\n    var isDesktop = tryToCheckIsDesktop(viewWidth, viewHeight, hasPointer, platform);\n    return {\n      viewWidth: viewWidth,\n      viewHeight: viewHeight,\n      sizeX: sizeX,\n      sizeY: sizeY,\n      hasPointer: hasPointer,\n      hasHover: hasHover,\n      isDesktop: isDesktop\n    };\n  }, [viewWidthLocal, viewHeightLocal, viewWidthContext, viewHeightContext, sizeXContext, sizeYContext, hasPointerContext, hasHoverContext, platform]);\n  React.useEffect(function () {\n    var handleMediaQuery = function handleMediaQuery() {\n      setViewSizeLocal(function (prevSizeLocal) {\n        var newViewWidthLocal = getOrDefault(viewWidthContext, getViewWidthByMediaQueries(mediaQueries));\n        var newViewHeightLocal = getOrDefault(viewHeightContext, getViewHeightByMediaQueries(mediaQueries));\n        var _prevSizeLocal = _slicedToArray(prevSizeLocal, 2),\n          prevViewWidthLocal = _prevSizeLocal[0],\n          prevViewHeightLocal = _prevSizeLocal[1];\n        if (prevViewWidthLocal !== newViewWidthLocal || prevViewHeightLocal !== newViewHeightLocal) {\n          return [newViewWidthLocal, newViewHeightLocal];\n        }\n        return prevSizeLocal;\n      });\n    };\n    if (!viewWidthContext) {\n      [mediaQueries.desktopPlus, mediaQueries.tablet, mediaQueries.smallTablet, mediaQueries.mobile].forEach(function (matchMediaListener) {\n        return matchMediaListAddListener(matchMediaListener, handleMediaQuery);\n      });\n    }\n    if (!viewHeightContext) {\n      [mediaQueries.mediumHeight, mediaQueries.mobileLandscapeHeight].forEach(function (matchMediaListener) {\n        return matchMediaListAddListener(matchMediaListener, handleMediaQuery);\n      });\n    }\n    return function () {\n      [mediaQueries.desktopPlus, mediaQueries.tablet, mediaQueries.smallTablet, mediaQueries.mobile, mediaQueries.mediumHeight, mediaQueries.mobileLandscapeHeight].forEach(function (matchMediaListener) {\n        return matchMediaListRemoveListener(matchMediaListener, handleMediaQuery);\n      });\n    };\n  }, [mediaQueries, viewWidthContext, viewHeightContext]);\n  return adaptivityProps;\n};","map":{"version":3,"names":["React","canUseDOM","hasMouse","hasPointerLib","hasHover","hasHoverLib","AdaptivityContext","getOrDefault","getViewWidthByMediaQueries","getViewHeightByMediaQueries","getSizeX","getSizeY","tryToCheckIsDesktop","useMediaQueries","usePlatform","matchMediaListAddListener","matchMediaListRemoveListener","useAdaptivityWithJSMediaQueries","console","error","_React$useContext","useContext","viewWidthContext","viewWidth","viewHeightContext","viewHeight","sizeXContext","sizeX","sizeYContext","sizeY","hasPointerContext","hasPointer","hasHoverContext","platform","mediaQueries","_React$useState","useState","_React$useState2","_slicedToArray","_React$useState2$","viewWidthLocal","viewHeightLocal","setViewSizeLocal","adaptivityProps","useMemo","isDesktop","useEffect","handleMediaQuery","prevSizeLocal","newViewWidthLocal","newViewHeightLocal","_prevSizeLocal","prevViewWidthLocal","prevViewHeightLocal","desktopPlus","tablet","smallTablet","mobile","forEach","matchMediaListener","mediumHeight","mobileLandscapeHeight"],"sources":["E:\\lessonReactForm\\mini-app\\node_modules\\@vkontakte\\vkui\\src\\hooks\\useAdaptivityWithJSMediaQueries.ts"],"sourcesContent":["import * as React from 'react';\nimport { canUseDOM, hasMouse as hasPointerLib, hasHover as hasHoverLib } from '@vkontakte/vkjs';\nimport {\n  AdaptivityContext,\n  type AdaptivityProps as BaseAdaptivityProps,\n} from '../components/AdaptivityProvider/AdaptivityContext';\nimport { getOrDefault } from '../helpers/getOrDefault';\nimport {\n  getViewWidthByMediaQueries,\n  getViewHeightByMediaQueries,\n  getSizeX,\n  getSizeY,\n  tryToCheckIsDesktop,\n} from '../lib/adaptivity';\nimport { useMediaQueries } from './useMediaQueries';\nimport { usePlatform } from './usePlatform';\nimport { matchMediaListAddListener, matchMediaListRemoveListener } from '../lib/matchMedia';\n\nexport interface UseAdaptivityWithJSMediaQueries extends Required<BaseAdaptivityProps> {\n  isDesktop: boolean;\n}\n\n/**\n * Высчитывает и возвращает параметры адаптивности при изменении вьюпорта.\n *\n * Берёт в приоритет значения из `AdaptivityContext`.\n *\n * > ⚠ SSR\n * >\n * > Во избежания ошибок при гидратации, не используйте данный хук, если есть вероятность, что компонент будет отрендерен\n * > на стороне сервера.\n * >\n * > Лучше всего использовать для всплывающих окон, т.к. они вызываются только после загрузки\n * > страницы либо пользователем, либо программно.\n */\nexport const useAdaptivityWithJSMediaQueries = (): UseAdaptivityWithJSMediaQueries => {\n  if (!canUseDOM) {\n    console.error(`[useAdaptivityWithJSMediaQueries] Похоже, вы пытаетесь использовать хук вне браузера.\n\nПостарайтесь этого избегать, чтобы не было ошибок при гидратации: при SSR нет информации о размерах экрана.\n\nИспользуйте CSS Media Query или библиотеку по типу https://github.com/artsy/fresnel.`);\n  }\n\n  const {\n    viewWidth: viewWidthContext,\n    viewHeight: viewHeightContext,\n    sizeX: sizeXContext,\n    sizeY: sizeYContext,\n    hasPointer: hasPointerContext,\n    hasHover: hasHoverContext,\n  } = React.useContext(AdaptivityContext);\n\n  const platform = usePlatform();\n  const mediaQueries = useMediaQueries();\n\n  const [[viewWidthLocal, viewHeightLocal], setViewSizeLocal] = React.useState(() => [\n    getOrDefault(viewWidthContext, getViewWidthByMediaQueries(mediaQueries)),\n    getOrDefault(viewHeightContext, getViewHeightByMediaQueries(mediaQueries)),\n  ]);\n\n  const adaptivityProps = React.useMemo(() => {\n    const hasPointer = getOrDefault(hasPointerContext, hasPointerLib);\n    const hasHover = getOrDefault(hasHoverContext, hasHoverLib);\n    const viewWidth = getOrDefault(viewWidthContext, viewWidthLocal);\n    const viewHeight = getOrDefault(viewHeightContext, viewHeightLocal);\n    const sizeX = getOrDefault(sizeXContext, getSizeX(viewWidth));\n    const sizeY = getOrDefault(sizeYContext, getSizeY(viewWidth, viewHeight, hasPointer));\n    const isDesktop = tryToCheckIsDesktop(viewWidth, viewHeight, hasPointer, platform);\n\n    return {\n      viewWidth,\n      viewHeight,\n      sizeX,\n      sizeY,\n      hasPointer,\n      hasHover,\n      isDesktop,\n    };\n  }, [\n    viewWidthLocal,\n    viewHeightLocal,\n    viewWidthContext,\n    viewHeightContext,\n    sizeXContext,\n    sizeYContext,\n    hasPointerContext,\n    hasHoverContext,\n    platform,\n  ]);\n\n  React.useEffect(() => {\n    const handleMediaQuery = () => {\n      setViewSizeLocal((prevSizeLocal) => {\n        const newViewWidthLocal = getOrDefault(\n          viewWidthContext,\n          getViewWidthByMediaQueries(mediaQueries),\n        );\n        const newViewHeightLocal = getOrDefault(\n          viewHeightContext,\n          getViewHeightByMediaQueries(mediaQueries),\n        );\n\n        const [prevViewWidthLocal, prevViewHeightLocal] = prevSizeLocal;\n\n        if (\n          prevViewWidthLocal !== newViewWidthLocal ||\n          prevViewHeightLocal !== newViewHeightLocal\n        ) {\n          return [newViewWidthLocal, newViewHeightLocal];\n        }\n\n        return prevSizeLocal;\n      });\n    };\n\n    if (!viewWidthContext) {\n      [\n        mediaQueries.desktopPlus,\n        mediaQueries.tablet,\n        mediaQueries.smallTablet,\n        mediaQueries.mobile,\n      ].forEach((matchMediaListener) =>\n        matchMediaListAddListener(matchMediaListener, handleMediaQuery),\n      );\n    }\n\n    if (!viewHeightContext) {\n      [mediaQueries.mediumHeight, mediaQueries.mobileLandscapeHeight].forEach(\n        (matchMediaListener) => matchMediaListAddListener(matchMediaListener, handleMediaQuery),\n      );\n    }\n\n    return () => {\n      [\n        mediaQueries.desktopPlus,\n        mediaQueries.tablet,\n        mediaQueries.smallTablet,\n        mediaQueries.mobile,\n        mediaQueries.mediumHeight,\n        mediaQueries.mobileLandscapeHeight,\n      ].forEach((matchMediaListener) =>\n        matchMediaListRemoveListener(matchMediaListener, handleMediaQuery),\n      );\n    };\n  }, [mediaQueries, viewWidthContext, viewHeightContext]);\n\n  return adaptivityProps;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
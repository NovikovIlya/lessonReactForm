{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport * as React from 'react';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nexport var ModalRootContext = /*#__PURE__*/React.createContext({\n  updateModalHeight: function updateModalHeight() {\n    return undefined;\n  },\n  registerModal: function registerModal() {\n    return undefined;\n  },\n  isInsideModal: false\n});\n\n/**\n * All referenced elements must be static\n */\nexport function useModalRegistry(id, type) {\n  var modalContext = React.useContext(ModalRootContext);\n  var elements = React.useRef({}).current;\n  useIsomorphicLayoutEffect(function () {\n    if (id !== undefined) {\n      modalContext.registerModal(_objectSpread(_objectSpread({}, elements), {}, {\n        type: type,\n        id: id\n      }));\n      // unset refs on  unmount to prevent leak\n      var reset = Object.keys(elements).reduce(function (acc, k) {\n        return _objectSpread(_objectSpread({}, acc), {}, _defineProperty({}, k, null));\n      }, {\n        type: type,\n        id: id\n      });\n      return function () {\n        return modalContext.registerModal(reset);\n      };\n    }\n    return undefined;\n  }, []);\n  var refs = React.useRef({\n    modalElement: function modalElement(e) {\n      return elements.modalElement = e;\n    },\n    innerElement: function innerElement(e) {\n      return elements.innerElement = e;\n    },\n    headerElement: function headerElement(e) {\n      return elements.headerElement = e;\n    },\n    contentElement: function contentElement(e) {\n      return elements.contentElement = e;\n    }\n  }).current;\n  return {\n    refs: refs\n  };\n}","map":{"version":3,"names":["React","useIsomorphicLayoutEffect","ModalRootContext","createContext","updateModalHeight","undefined","registerModal","isInsideModal","useModalRegistry","id","type","modalContext","useContext","elements","useRef","current","_objectSpread","reset","Object","keys","reduce","acc","k","_defineProperty","refs","modalElement","e","innerElement","headerElement","contentElement"],"sources":["E:\\lessonReactForm\\mini-app\\node_modules\\@vkontakte\\vkui\\src\\components\\ModalRoot\\ModalRootContext.tsx"],"sourcesContent":["import * as React from 'react';\nimport { useIsomorphicLayoutEffect } from '../../lib/useIsomorphicLayoutEffect';\nimport { ModalElements, ModalsStateEntry, ModalType } from './types';\n\nexport type ModalRegistryEntry = ModalElements & Required<Pick<ModalsStateEntry, 'type' | 'id'>>;\ntype ModalRefs = { [k in keyof ModalElements]: (e: ModalElements[k]) => void };\n\nexport interface ModalRootContextInterface {\n  updateModalHeight: VoidFunction;\n  registerModal(data: ModalRegistryEntry): void;\n  onClose?: VoidFunction;\n  isInsideModal: boolean;\n}\n\nexport const ModalRootContext = React.createContext<ModalRootContextInterface>({\n  updateModalHeight: () => undefined,\n  registerModal: () => undefined,\n  isInsideModal: false,\n});\n\n/**\n * All referenced elements must be static\n */\nexport function useModalRegistry(id: string | undefined, type: ModalType) {\n  const modalContext = React.useContext(ModalRootContext);\n  const elements = React.useRef<ModalElements>({}).current;\n  useIsomorphicLayoutEffect(() => {\n    if (id !== undefined) {\n      modalContext.registerModal({ ...elements, type, id });\n      // unset refs on  unmount to prevent leak\n      const reset = Object.keys(elements).reduce<ModalRegistryEntry>(\n        (acc, k) => ({ ...acc, [k]: null }),\n        { type, id },\n      );\n      return () => modalContext.registerModal(reset);\n    }\n    return undefined;\n  }, []);\n\n  const refs = React.useRef<Required<ModalRefs>>({\n    modalElement: (e) => (elements.modalElement = e),\n    innerElement: (e) => (elements.innerElement = e),\n    headerElement: (e) => (elements.headerElement = e),\n    contentElement: (e) => (elements.contentElement = e),\n  }).current;\n  return { refs };\n}\n"],"mappings":";;AAAA,OAAO,KAAKA,KAAK,MAAM,OAAO;AAC9B,SAASC,yBAAyB,QAAQ,qCAAqC;AAa/E,OAAO,IAAMC,gBAAgB,gBAAGF,KAAK,CAACG,aAAa,CAA4B;EAC7EC,iBAAiB,EAAE,SAAAA,kBAAA;IAAA,OAAMC,SAAS;EAAA;EAClCC,aAAa,EAAE,SAAAA,cAAA;IAAA,OAAMD,SAAS;EAAA;EAC9BE,aAAa,EAAE;AACjB,CAAC,CAAC;;AAEF;AACA;AACA;AACA,OAAO,SAASC,gBAAgBA,CAACC,EAAsB,EAAEC,IAAe,EAAE;EACxE,IAAMC,YAAY,GAAGX,KAAK,CAACY,UAAU,CAACV,gBAAgB,CAAC;EACvD,IAAMW,QAAQ,GAAGb,KAAK,CAACc,MAAM,CAAgB,CAAC,CAAC,CAAC,CAACC,OAAO;EACxDd,yBAAyB,CAAC,YAAM;IAC9B,IAAIQ,EAAE,KAAKJ,SAAS,EAAE;MACpBM,YAAY,CAACL,aAAa,CAAAU,aAAA,CAAAA,aAAA,KAAMH,QAAQ;QAAEH,IAAI,EAAJA,IAAI;QAAED,EAAE,EAAFA;MAAE,GAAG;MACrD;MACA,IAAMQ,KAAK,GAAGC,MAAM,CAACC,IAAI,CAACN,QAAQ,CAAC,CAACO,MAAM,CACxC,UAACC,GAAG,EAAEC,CAAC;QAAA,OAAAN,aAAA,CAAAA,aAAA,KAAWK,GAAG,OAAAE,eAAA,KAAGD,CAAC,EAAG,IAAI;MAAA,CAAG,EACnC;QAAEZ,IAAI,EAAJA,IAAI;QAAED,EAAE,EAAFA;MAAG,CAAC,CACb;MACD,OAAO;QAAA,OAAME,YAAY,CAACL,aAAa,CAACW,KAAK,CAAC;MAAA;IAChD;IACA,OAAOZ,SAAS;EAClB,CAAC,EAAE,EAAE,CAAC;EAEN,IAAMmB,IAAI,GAAGxB,KAAK,CAACc,MAAM,CAAsB;IAC7CW,YAAY,EAAE,SAAAA,aAACC,CAAC;MAAA,OAAMb,QAAQ,CAACY,YAAY,GAAGC,CAAC;IAAA,CAAC;IAChDC,YAAY,EAAE,SAAAA,aAACD,CAAC;MAAA,OAAMb,QAAQ,CAACc,YAAY,GAAGD,CAAC;IAAA,CAAC;IAChDE,aAAa,EAAE,SAAAA,cAACF,CAAC;MAAA,OAAMb,QAAQ,CAACe,aAAa,GAAGF,CAAC;IAAA,CAAC;IAClDG,cAAc,EAAE,SAAAA,eAACH,CAAC;MAAA,OAAMb,QAAQ,CAACgB,cAAc,GAAGH,CAAC;IAAA;EACrD,CAAC,CAAC,CAACX,OAAO;EACV,OAAO;IAAES,IAAI,EAAJA;EAAK,CAAC;AACjB"},"metadata":{},"sourceType":"module","externalDependencies":[]}
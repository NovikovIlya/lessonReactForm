{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _objectSpread from \"@babel/runtime/helpers/objectSpread2\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _createSuper from \"@babel/runtime/helpers/createSuper\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nvar _excluded = [\"popout\", \"modal\", \"platform\", \"activePanel\", \"splitCol\", \"configProvider\", \"history\", \"id\", \"nav\", \"onTransition\", \"onSwipeBack\", \"onSwipeBackStart\", \"onSwipeBackCancel\", \"window\", \"document\", \"scroll\", \"isBackCheck\", \"className\"];\nimport * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { transitionEvent, animationEvent } from '../../lib/supportEvents';\nimport { getPlatformClassName } from '../../helpers/getPlatformClassName';\nimport { Platform } from '../../lib/platform';\nimport { Touch } from '../Touch/Touch';\nimport { withPlatform } from '../../hoc/withPlatform';\nimport { withContext } from '../../hoc/withContext';\nimport { ConfigProviderContext } from '../ConfigProvider/ConfigProviderContext';\nimport { SplitColContext } from '../SplitCol/SplitCol';\nimport { AppRootPortal } from '../AppRoot/AppRootPortal';\nimport { canUseDOM, withDOM } from '../../lib/dom';\nimport { ScrollContext } from '../AppRoot/ScrollContext';\nimport { NavTransitionProvider } from '../NavTransitionContext/NavTransitionContext';\nimport { getNavId } from '../../lib/getNavId';\nimport { warnOnce } from '../../lib/warnOnce';\nimport { swipeBackExcluded } from './utils';\nvar warn = warnOnce('ViewInfinite');\nvar SwipeBackResults;\n(function (SwipeBackResults) {\n  SwipeBackResults[SwipeBackResults[\"fail\"] = 1] = \"fail\";\n  SwipeBackResults[SwipeBackResults[\"success\"] = 2] = \"success\";\n})(SwipeBackResults || (SwipeBackResults = {}));\nvar scrollsCache = {};\nvar ViewInfiniteComponent = /*#__PURE__*/function (_React$Component) {\n  _inherits(ViewInfiniteComponent, _React$Component);\n  var _super = _createSuper(ViewInfiniteComponent);\n  function ViewInfiniteComponent(props) {\n    var _this;\n    _classCallCheck(this, ViewInfiniteComponent);\n    _this = _super.call(this, props);\n    _defineProperty(_assertThisInitialized(_this), \"scrolls\", scrollsCache[getNavId(_this.props, warn)] || {});\n    _defineProperty(_assertThisInitialized(_this), \"transitionFinishTimeout\", undefined);\n    _defineProperty(_assertThisInitialized(_this), \"animationFinishTimeout\", undefined);\n    _defineProperty(_assertThisInitialized(_this), \"panelNodes\", {});\n    _defineProperty(_assertThisInitialized(_this), \"transitionEndHandler\", function (e) {\n      if ((!e || ['vkui-animation-ios-next-forward', 'vkui-animation-ios-prev-back', 'vkui-animation-view-next-forward', 'vkui-animation-view-prev-back'].includes(e.animationName)) && _this.state.prevPanel !== null) {\n        _this.flushTransition(_this.state.prevPanel, Boolean(_this.state.isBack));\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"swipingBackTransitionEndHandler\", function (e) {\n      // indexOf because of vendor prefixes in old browsers\n      if (!e || e.propertyName.includes('transform') && e.target === _this.pickPanel(_this.state.swipeBackNextPanel)) {\n        switch (_this.state.swipeBackResult) {\n          case SwipeBackResults.fail:\n            _this.onSwipeBackCancel();\n            break;\n          case SwipeBackResults.success:\n            _this.onSwipeBackSuccess();\n        }\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onMoveX\", function (event) {\n      var _this$props$configPro;\n      if (!_this.window || _this.props.platform !== Platform.IOS || _this.state.swipeBackPrevented || swipeBackExcluded(event) || _this.shouldDisableTransitionMotion()) {\n        return;\n      }\n      if (!((_this$props$configPro = _this.props.configProvider) !== null && _this$props$configPro !== void 0 && _this$props$configPro.isWebView)) {\n        if ((event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA || event.startX >= _this.window.innerWidth - ViewInfiniteComponent.SWIPE_BACK_AREA) && !_this.state.browserSwipe) {\n          _this.setState({\n            browserSwipe: true\n          });\n        }\n        return;\n      }\n      if (!_this.props.onSwipeBack || _this.state.animated && event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA) {\n        return;\n      }\n      if (!_this.state.swipingBack && event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA && _this.props.history && _this.props.history.length > 1) {\n        if (_this.props.onSwipeBackStart) {\n          var payload = _this.props.onSwipeBackStart(_this.state.activePanel);\n          if (payload === 'prevent') {\n            _this.setState({\n              swipeBackPrevented: true\n            });\n            return;\n          }\n        }\n        if (_this.state.activePanel !== null) {\n          var _this$props$scroll;\n          // Note: вызываем закрытие клавиатуры. В iOS это нативное поведение при свайпе.\n          _this.blurActiveElement();\n          var prevScrolls = _this.scrolls[_this.state.activePanel] || [];\n          _this.scrolls = _objectSpread(_objectSpread({}, _this.scrolls), {}, _defineProperty({}, _this.state.activePanel, [].concat(_toConsumableArray(prevScrolls), [(_this$props$scroll = _this.props.scroll) === null || _this$props$scroll === void 0 ? void 0 : _this$props$scroll.getScroll().y])));\n        }\n        _this.setState({\n          swipingBack: true,\n          swipeBackStartX: event.startX,\n          swipeBackPrevPanel: _this.state.activePanel,\n          swipeBackNextPanel: _this.props.history.slice(-2)[0]\n        });\n      }\n      if (_this.state.swipingBack) {\n        var swipeBackShift;\n        if (event.shiftX < 0) {\n          swipeBackShift = 0;\n        } else if (event.shiftX > _this.window.innerWidth - _this.state.swipeBackStartX) {\n          swipeBackShift = _this.window.innerWidth;\n        } else {\n          swipeBackShift = event.shiftX;\n        }\n        _this.setState({\n          swipeBackShift: swipeBackShift\n        });\n      }\n    });\n    _defineProperty(_assertThisInitialized(_this), \"onEnd\", function (event) {\n      if (_this.state.swipingBack && _this.window) {\n        var speed = _this.state.swipeBackShift / event.duration * 1000;\n        if (_this.state.swipeBackShift === 0) {\n          _this.onSwipeBackCancel();\n        } else if (_this.state.swipeBackShift >= _this.window.innerWidth) {\n          _this.onSwipeBackSuccess();\n        } else if (speed > 250 || _this.state.swipeBackStartX + _this.state.swipeBackShift > _this.window.innerWidth / 2) {\n          _this.setState({\n            swipeBackResult: SwipeBackResults.success\n          });\n        } else {\n          _this.setState({\n            swipeBackResult: SwipeBackResults.fail\n          });\n        }\n      }\n      if (_this.state.swipeBackPrevented) {\n        _this.setState({\n          swipeBackPrevented: false\n        });\n      }\n    });\n    _this.state = {\n      animated: false,\n      visiblePanels: [props.activePanel],\n      activePanel: props.activePanel,\n      isBack: undefined,\n      prevPanel: null,\n      nextPanel: null,\n      swipingBack: false,\n      swipeBackPrevented: false,\n      swipeBackStartX: 0,\n      swipeBackShift: 0,\n      swipeBackNextPanel: null,\n      swipeBackPrevPanel: null,\n      swipeBackResult: null,\n      browserSwipe: false\n    };\n    return _this;\n  }\n  _createClass(ViewInfiniteComponent, [{\n    key: \"document\",\n    get: function get() {\n      return this.props.document;\n    }\n  }, {\n    key: \"window\",\n    get: function get() {\n      return this.props.window;\n    }\n  }, {\n    key: \"panels\",\n    get: function get() {\n      return React.Children.toArray(this.props.children);\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      var id = getNavId(this.props);\n      if (id) {\n        scrollsCache[id] = this.scrolls;\n      }\n      if (this.animationFinishTimeout) {\n        clearTimeout(this.animationFinishTimeout);\n      }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, prevState) {\n      var _this2 = this;\n      this.props.popout && !prevProps.popout && this.blurActiveElement();\n      this.props.modal && !prevProps.modal && this.blurActiveElement();\n\n      // Нужен переход\n      if (prevProps.activePanel !== this.props.activePanel && !prevState.swipingBack && !prevState.browserSwipe) {\n        var _this$props$scroll2;\n        var isBack = false;\n        if (this.props.isBackCheck) {\n          isBack = this.props.isBackCheck({\n            from: prevProps.activePanel,\n            to: this.props.activePanel\n          });\n        } else {\n          var firstLayerId = this.panels.map(function (panel) {\n            return getNavId(panel.props, warn);\n          }).find(function (id) {\n            return id === prevProps.activePanel || id === _this2.props.activePanel;\n          });\n          isBack = firstLayerId === this.props.activePanel;\n        }\n        this.blurActiveElement();\n        var prevScrolls = this.scrolls[prevProps.activePanel] || [];\n        var scrolls = _objectSpread(_objectSpread({}, this.scrolls), {}, _defineProperty({}, prevProps.activePanel, [].concat(_toConsumableArray(prevScrolls), [(_this$props$scroll2 = this.props.scroll) === null || _this$props$scroll2 === void 0 ? void 0 : _this$props$scroll2.getScroll().y])));\n        this.scrolls = scrolls;\n        if (this.shouldDisableTransitionMotion()) {\n          this.flushTransition(prevProps.activePanel, isBack);\n        } else {\n          this.setState({\n            visiblePanels: [prevProps.activePanel, this.props.activePanel],\n            prevPanel: prevProps.activePanel,\n            nextPanel: this.props.activePanel,\n            activePanel: null,\n            animated: true,\n            isBack: isBack\n          });\n\n          // Фолбек анимации перехода\n          if (!animationEvent.supported) {\n            if (this.animationFinishTimeout) {\n              clearTimeout(this.animationFinishTimeout);\n            }\n            this.animationFinishTimeout = setTimeout(this.transitionEndHandler, this.props.platform === Platform.ANDROID || this.props.platform === Platform.VKCOM ? 300 : 600);\n          }\n        }\n      }\n\n      // Закончилась анимация свайпа назад\n      if (prevProps.activePanel !== this.props.activePanel && prevState.swipingBack) {\n        var nextPanel = this.state.swipeBackNextPanel;\n        var prevPanel = this.state.swipeBackPrevPanel;\n        var scrollPosition = undefined;\n        this.scrolls = _objectSpread({}, this.scrolls);\n        if (prevPanel !== null) {\n          var prevPanelScrolls = _toConsumableArray(this.scrolls[prevPanel] || []).slice(0, -1);\n          this.scrolls[prevPanel] = prevPanelScrolls;\n        }\n        if (nextPanel !== null) {\n          var newPanelScrolls = _toConsumableArray(this.scrolls[nextPanel] || []);\n          scrollPosition = newPanelScrolls.pop();\n          this.scrolls[nextPanel] = newPanelScrolls;\n        }\n        this.setState({\n          swipeBackPrevPanel: null,\n          swipeBackNextPanel: null,\n          swipingBack: false,\n          swipeBackResult: null,\n          swipeBackStartX: 0,\n          swipeBackShift: 0,\n          activePanel: nextPanel,\n          visiblePanels: [nextPanel]\n        }, function () {\n          var _this2$props$scroll;\n          (_this2$props$scroll = _this2.props.scroll) === null || _this2$props$scroll === void 0 ? void 0 : _this2$props$scroll.scrollTo(0, scrollPosition);\n          prevProps.onTransition && prevProps.onTransition({\n            isBack: true,\n            from: prevPanel,\n            to: nextPanel\n          });\n        });\n      }\n\n      // Началась анимация завершения свайпа назад.\n      if (!prevState.swipeBackResult && this.state.swipeBackResult) {\n        this.waitTransitionFinish(this.pickPanel(this.state.swipeBackNextPanel), this.swipingBackTransitionEndHandler);\n      }\n\n      // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n      if (prevState.swipeBackResult === SwipeBackResults.fail && !this.state.swipeBackResult && this.state.activePanel !== null) {\n        var _this$props$scroll3;\n        var _newPanelScrolls = _toConsumableArray(this.scrolls[this.state.activePanel] || []);\n        var _scrollPosition = _newPanelScrolls.pop();\n        this.scrolls = _objectSpread(_objectSpread({}, this.scrolls), {}, _defineProperty({}, this.state.activePanel, _newPanelScrolls));\n        (_this$props$scroll3 = this.props.scroll) === null || _this$props$scroll3 === void 0 ? void 0 : _this$props$scroll3.scrollTo(0, _scrollPosition);\n      }\n\n      // Закончился Safari свайп\n      if (prevProps.activePanel !== this.props.activePanel && this.state.browserSwipe) {\n        this.setState({\n          browserSwipe: false,\n          nextPanel: null,\n          prevPanel: null,\n          animated: false,\n          visiblePanels: [this.props.activePanel],\n          activePanel: this.props.activePanel\n        });\n      }\n    }\n  }, {\n    key: \"shouldDisableTransitionMotion\",\n    value: function shouldDisableTransitionMotion() {\n      var _this$props$configPro2, _this$props$splitCol;\n      return ((_this$props$configPro2 = this.props.configProvider) === null || _this$props$configPro2 === void 0 ? void 0 : _this$props$configPro2.transitionMotionEnabled) === false || !((_this$props$splitCol = this.props.splitCol) !== null && _this$props$splitCol !== void 0 && _this$props$splitCol.animate) || this.props.platform === Platform.VKCOM;\n    }\n  }, {\n    key: \"waitTransitionFinish\",\n    value: function waitTransitionFinish(elem, eventHandler) {\n      if (transitionEvent.supported && transitionEvent.name && elem) {\n        elem.removeEventListener(transitionEvent.name, eventHandler);\n        elem.addEventListener(transitionEvent.name, eventHandler);\n      } else {\n        if (this.transitionFinishTimeout) {\n          clearTimeout(this.transitionFinishTimeout);\n        }\n        this.transitionFinishTimeout = setTimeout(eventHandler, this.props.platform === Platform.ANDROID || this.props.platform === Platform.VKCOM ? 300 : 600);\n      }\n    }\n  }, {\n    key: \"blurActiveElement\",\n    value: function blurActiveElement() {\n      var _this$document;\n      if (typeof this.window !== 'undefined' && (_this$document = this.document) !== null && _this$document !== void 0 && _this$document.activeElement) {\n        this.document.activeElement.blur();\n      }\n    }\n  }, {\n    key: \"pickPanel\",\n    value: function pickPanel(id) {\n      if (id === null) {\n        return undefined;\n      }\n      return this.panelNodes[id];\n    }\n  }, {\n    key: \"flushTransition\",\n    value: function flushTransition(prevPanel, isBack) {\n      var _this3 = this;\n      var activePanel = this.props.activePanel;\n      var prevPanelScrolls = _toConsumableArray(this.scrolls[prevPanel] || []).slice(0, -1);\n      var newPanelScrolls = _toConsumableArray(this.scrolls[activePanel] || []);\n      var scrollPosition = isBack ? newPanelScrolls.pop() : 0;\n      if (isBack) {\n        var _objectSpread5;\n        this.scrolls = _objectSpread(_objectSpread({}, this.scrolls), {}, (_objectSpread5 = {}, _defineProperty(_objectSpread5, prevPanel, prevPanelScrolls), _defineProperty(_objectSpread5, activePanel, newPanelScrolls), _objectSpread5));\n      }\n      this.setState({\n        prevPanel: null,\n        nextPanel: null,\n        visiblePanels: [activePanel],\n        activePanel: activePanel,\n        animated: false,\n        isBack: undefined\n      }, function () {\n        var _this3$props$scroll;\n        (_this3$props$scroll = _this3.props.scroll) === null || _this3$props$scroll === void 0 ? void 0 : _this3$props$scroll.scrollTo(0, isBack ? scrollPosition : 0);\n        _this3.props.onTransition && _this3.props.onTransition({\n          isBack: isBack,\n          from: prevPanel,\n          to: activePanel\n        });\n      });\n    }\n  }, {\n    key: \"onSwipeBackSuccess\",\n    value: function onSwipeBackSuccess() {\n      this.props.onSwipeBack && this.props.onSwipeBack();\n    }\n  }, {\n    key: \"onSwipeBackCancel\",\n    value: function onSwipeBackCancel() {\n      this.props.onSwipeBackCancel && this.props.onSwipeBackCancel();\n      this.setState({\n        swipeBackPrevPanel: null,\n        swipeBackNextPanel: null,\n        swipingBack: false,\n        swipeBackResult: null,\n        swipeBackStartX: 0,\n        swipeBackShift: 0\n      });\n    }\n  }, {\n    key: \"calcPanelSwipeStyles\",\n    value: function calcPanelSwipeStyles(panelId) {\n      if (!canUseDOM || !this.window) {\n        return {};\n      }\n      var isPrev = panelId === this.state.swipeBackPrevPanel;\n      var isNext = panelId === this.state.swipeBackNextPanel;\n      if (!isPrev && !isNext || this.state.swipeBackResult) {\n        return {};\n      }\n      var prevPanelTranslate = \"\".concat(this.state.swipeBackShift, \"px\");\n      var nextPanelTranslate = \"\".concat(-50 + this.state.swipeBackShift * 100 / this.window.innerWidth / 2, \"%\");\n      var prevPanelShadow = 0.3 * (this.window.innerWidth - this.state.swipeBackShift) / this.window.innerWidth;\n      if (this.state.swipeBackResult) {\n        return isPrev ? {\n          boxShadow: \"-2px 0 12px rgba(0, 0, 0, \".concat(prevPanelShadow, \")\")\n        } : {};\n      }\n      if (isNext) {\n        return {\n          transform: \"translate3d(\".concat(nextPanelTranslate, \", 0, 0)\"),\n          WebkitTransform: \"translate3d(\".concat(nextPanelTranslate, \", 0, 0)\")\n        };\n      }\n      if (isPrev) {\n        return {\n          transform: \"translate3d(\".concat(prevPanelTranslate, \", 0, 0)\"),\n          WebkitTransform: \"translate3d(\".concat(prevPanelTranslate, \", 0, 0)\"),\n          boxShadow: \"-2px 0 12px rgba(0, 0, 0, \".concat(prevPanelShadow, \")\")\n        };\n      }\n      return {};\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this4 = this;\n      var _this$props = this.props,\n        popout = _this$props.popout,\n        modal = _this$props.modal,\n        platform = _this$props.platform,\n        _1 = _this$props.activePanel,\n        splitCol = _this$props.splitCol,\n        configProvider = _this$props.configProvider,\n        history = _this$props.history,\n        id = _this$props.id,\n        nav = _this$props.nav,\n        onTransition = _this$props.onTransition,\n        onSwipeBack = _this$props.onSwipeBack,\n        onSwipeBackStart = _this$props.onSwipeBackStart,\n        onSwipeBackCancel = _this$props.onSwipeBackCancel,\n        window = _this$props.window,\n        document = _this$props.document,\n        scroll = _this$props.scroll,\n        isBackCheck = _this$props.isBackCheck,\n        className = _this$props.className,\n        restProps = _objectWithoutProperties(_this$props, _excluded);\n      var _this$state = this.state,\n        prevPanel = _this$state.prevPanel,\n        nextPanel = _this$state.nextPanel,\n        activePanel = _this$state.activePanel,\n        isBack = _this$state.isBack,\n        animated = _this$state.animated,\n        swipeBackPrevPanel = _this$state.swipeBackPrevPanel,\n        swipeBackNextPanel = _this$state.swipeBackNextPanel,\n        swipeBackResult = _this$state.swipeBackResult,\n        swipingBack = _this$state.swipingBack;\n      var hasPopout = !!popout;\n      var hasModal = !!modal;\n      var panels = this.panels.filter(function (panel) {\n        var panelId = getNavId(panel.props, warn);\n        return panelId !== undefined && _this4.state.visiblePanels.includes(panelId) || panelId === swipeBackPrevPanel || panelId === swipeBackNextPanel;\n      }).sort(function (panel) {\n        var panelId = getNavId(panel.props, warn);\n        var isPrevPanel = panelId === prevPanel || panelId === swipeBackPrevPanel;\n        var isNextPanel = panelId === nextPanel || panelId === swipeBackNextPanel;\n        if (isNextPanel) {\n          return swipingBack || _this4.state.isBack ? -1 : 1;\n        }\n        if (isPrevPanel) {\n          return swipingBack || _this4.state.isBack ? 1 : -1;\n        }\n        return 0;\n      });\n      var disableAnimation = this.shouldDisableTransitionMotion();\n      return /*#__PURE__*/React.createElement(Touch, _extends({\n        Component: \"section\"\n      }, restProps, {\n        className: classNames(\"vkuiView\", getPlatformClassName(\"vkuiView\", platform), !disableAnimation && this.state.animated && \"vkuiView--animated\", !disableAnimation && this.state.swipingBack && \"vkuiView--swiping-back\", disableAnimation && \"vkuiView--no-motion\", className),\n        onMoveX: this.onMoveX,\n        onEnd: this.onEnd\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"vkuiView__panels\"\n      }, panels.map(function (panel) {\n        var panelId = getNavId(panel.props, warn);\n        var isPrev = panelId === prevPanel || panelId === swipeBackPrevPanel;\n        var compensateScroll = isPrev || panelId === swipeBackNextPanel || panelId === nextPanel && isBack;\n        var isTransitionTarget = animated && panelId === (isBack ? prevPanel : nextPanel);\n        var scrollList = panelId && _this4.scrolls[panelId] || [];\n        var scroll = scrollList[scrollList.length - 1] || 0;\n        return /*#__PURE__*/React.createElement(\"div\", {\n          className: classNames(\"vkuiView__panel\", panelId === activePanel && \"vkuiView__panel--active\", panelId === prevPanel && \"vkuiView__panel--prev\", panelId === nextPanel && \"vkuiView__panel--next\", panelId === swipeBackPrevPanel && \"vkuiView__panel--swipe-back-prev\", panelId === swipeBackNextPanel && \"vkuiView__panel--swipe-back-next\", swipeBackResult === SwipeBackResults.success && \"vkuiView__panel--swipe-back-success\", swipeBackResult === SwipeBackResults.fail && \"vkuiView__panel--swipe-back-failed\"),\n          onAnimationEnd: isTransitionTarget ? _this4.transitionEndHandler : undefined,\n          ref: function ref(el) {\n            return panelId !== undefined && (_this4.panelNodes[panelId] = el);\n          },\n          style: _this4.calcPanelSwipeStyles(panelId),\n          key: panelId\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"vkuiView__panel-in\",\n          style: {\n            marginTop: compensateScroll ? -scroll : undefined\n          }\n        }, /*#__PURE__*/React.createElement(NavTransitionProvider, {\n          entering: panelId === nextPanel || panelId === swipeBackNextPanel\n        }, panel)));\n      })), /*#__PURE__*/React.createElement(AppRootPortal, null, hasPopout && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"vkuiView__popout\"\n      }, popout), hasModal && /*#__PURE__*/React.createElement(\"div\", {\n        className: \"vkuiView__modal\"\n      }, modal)));\n    }\n  }]);\n  return ViewInfiniteComponent;\n}(React.Component);\n_defineProperty(ViewInfiniteComponent, \"SWIPE_BACK_AREA\", 70);\n_defineProperty(ViewInfiniteComponent, \"defaultProps\", {\n  history: []\n});\nexport var ViewInfinite = withContext(withContext(withContext(withPlatform(withDOM(ViewInfiniteComponent)), SplitColContext, 'splitCol'), ConfigProviderContext, 'configProvider'), ScrollContext, 'scroll');","map":{"version":3,"names":["React","classNames","transitionEvent","animationEvent","getPlatformClassName","Platform","Touch","withPlatform","withContext","ConfigProviderContext","SplitColContext","AppRootPortal","canUseDOM","withDOM","ScrollContext","NavTransitionProvider","getNavId","warnOnce","swipeBackExcluded","warn","SwipeBackResults","scrollsCache","ViewInfiniteComponent","_React$Component","_inherits","_super","_createSuper","props","_this","_classCallCheck","call","_defineProperty","_assertThisInitialized","undefined","e","includes","animationName","state","prevPanel","flushTransition","Boolean","isBack","propertyName","target","pickPanel","swipeBackNextPanel","swipeBackResult","fail","onSwipeBackCancel","success","onSwipeBackSuccess","event","_this$props$configPro","window","platform","IOS","swipeBackPrevented","shouldDisableTransitionMotion","configProvider","isWebView","startX","SWIPE_BACK_AREA","innerWidth","browserSwipe","setState","onSwipeBack","animated","swipingBack","history","length","onSwipeBackStart","payload","activePanel","_this$props$scroll","blurActiveElement","prevScrolls","scrolls","_objectSpread","concat","_toConsumableArray","scroll","getScroll","y","swipeBackStartX","swipeBackPrevPanel","slice","swipeBackShift","shiftX","speed","duration","visiblePanels","nextPanel","_createClass","key","get","document","Children","toArray","children","value","componentWillUnmount","id","animationFinishTimeout","clearTimeout","componentDidUpdate","prevProps","prevState","_this2","popout","modal","_this$props$scroll2","isBackCheck","from","to","firstLayerId","panels","map","panel","find","supported","setTimeout","transitionEndHandler","ANDROID","VKCOM","scrollPosition","prevPanelScrolls","newPanelScrolls","pop","_this2$props$scroll","scrollTo","onTransition","waitTransitionFinish","swipingBackTransitionEndHandler","_this$props$scroll3","_newPanelScrolls","_scrollPosition","_this$props$configPro2","_this$props$splitCol","transitionMotionEnabled","splitCol","animate","elem","eventHandler","name","removeEventListener","addEventListener","transitionFinishTimeout","_this$document","activeElement","blur","panelNodes","_this3","_objectSpread5","_this3$props$scroll","calcPanelSwipeStyles","panelId","isPrev","isNext","prevPanelTranslate","nextPanelTranslate","prevPanelShadow","boxShadow","transform","WebkitTransform","render","_this4","_this$props","_1","nav","className","restProps","_objectWithoutProperties","_excluded","_this$state","hasPopout","hasModal","filter","sort","isPrevPanel","isNextPanel","disableAnimation","createElement","_extends","Component","onMoveX","onEnd","compensateScroll","isTransitionTarget","scrollList","onAnimationEnd","ref","el","style","marginTop","entering","ViewInfinite"],"sources":["E:\\lessonReactForm\\mini-app\\node_modules\\@vkontakte\\vkui\\src\\components\\View\\ViewInfinite.tsx"],"sourcesContent":["import * as React from 'react';\nimport { classNames } from '@vkontakte/vkjs';\nimport { transitionEvent, animationEvent } from '../../lib/supportEvents';\nimport { getPlatformClassName } from '../../helpers/getPlatformClassName';\nimport { Platform } from '../../lib/platform';\nimport { Touch, TouchEvent } from '../Touch/Touch';\nimport { HasPlatform } from '../../types';\nimport { withPlatform } from '../../hoc/withPlatform';\nimport { withContext } from '../../hoc/withContext';\nimport {\n  ConfigProviderContext,\n  ConfigProviderContextInterface,\n} from '../ConfigProvider/ConfigProviderContext';\nimport { SplitColContext, SplitColContextProps } from '../SplitCol/SplitCol';\nimport { AppRootPortal } from '../AppRoot/AppRootPortal';\nimport { canUseDOM, withDOM, DOMProps } from '../../lib/dom';\nimport { ScrollContext, ScrollContextInterface } from '../AppRoot/ScrollContext';\nimport { NavTransitionProvider } from '../NavTransitionContext/NavTransitionContext';\nimport { getNavId, NavIdProps } from '../../lib/getNavId';\nimport { warnOnce } from '../../lib/warnOnce';\nimport { swipeBackExcluded } from './utils';\nimport styles from './View.module.css';\nimport iosStyles from './ViewIOS.module.css';\n\nconst warn = warnOnce('ViewInfinite');\n\nenum SwipeBackResults {\n  fail = 1,\n  success,\n}\n\ninterface Scrolls {\n  [index: string]: Array<number | undefined>;\n}\n\ninterface ViewsScrolls {\n  [index: string]: Scrolls;\n}\n\ntype TransitionEventHandler = (e?: TransitionEvent) => void;\n\nlet scrollsCache: ViewsScrolls = {};\n\nexport type TransitionParams = { from: string | null; to: string | null };\n\nexport interface ViewInfiniteProps\n  extends React.HTMLAttributes<HTMLElement>,\n    HasPlatform,\n    NavIdProps {\n  activePanel: string;\n  popout?: React.ReactNode;\n  modal?: React.ReactNode;\n  onTransition?(params: TransitionParams & { isBack: boolean }): void;\n  /**\n   * callback свайпа назад\n   */\n  onSwipeBack?(): void;\n  /**\n   * callback начала анимации свайпа назад.\n   */\n  onSwipeBackStart?(activePanel: string | null): void | 'prevent';\n  /**\n   * callback завершения анимации отмененного пользователем свайпа\n   */\n  onSwipeBackCancel?(): void;\n  history?: string[];\n  isBackCheck?(params: TransitionParams): boolean;\n  /**\n   * @ignore\n   */\n  splitCol?: SplitColContextProps;\n  /**\n   * @ignore\n   */\n  configProvider?: ConfigProviderContextInterface;\n  /**\n   * @ignore\n   */\n  scroll?: ScrollContextInterface;\n}\n\nexport interface ViewInfiniteState {\n  animated: boolean;\n\n  visiblePanels: Array<string | null>;\n  activePanel: string | null;\n  isBack?: boolean;\n  prevPanel: string | null;\n  nextPanel: string | null;\n\n  swipingBack: boolean;\n  swipeBackPrevented: boolean;\n  swipeBackStartX: number;\n  swipeBackShift: number;\n  swipeBackNextPanel: string | null;\n  swipeBackPrevPanel: string | null;\n  swipeBackResult: SwipeBackResults | null;\n\n  browserSwipe: boolean;\n}\n\nclass ViewInfiniteComponent extends React.Component<\n  ViewInfiniteProps & DOMProps,\n  ViewInfiniteState\n> {\n  private static readonly SWIPE_BACK_AREA = 70;\n\n  constructor(props: ViewInfiniteProps) {\n    super(props);\n\n    this.state = {\n      animated: false,\n\n      visiblePanels: [props.activePanel],\n      activePanel: props.activePanel,\n      isBack: undefined,\n      prevPanel: null,\n      nextPanel: null,\n\n      swipingBack: false,\n      swipeBackPrevented: false,\n      swipeBackStartX: 0,\n      swipeBackShift: 0,\n      swipeBackNextPanel: null,\n      swipeBackPrevPanel: null,\n      swipeBackResult: null,\n\n      browserSwipe: false,\n    };\n  }\n\n  static defaultProps: Partial<ViewInfiniteProps> = {\n    history: [],\n  };\n\n  private scrolls = scrollsCache[getNavId(this.props, warn) as string] || {};\n  private transitionFinishTimeout: ReturnType<typeof setTimeout> | undefined = undefined;\n  private animationFinishTimeout: ReturnType<typeof setTimeout> | undefined = undefined;\n\n  get document() {\n    return this.props.document;\n  }\n\n  get window() {\n    return this.props.window;\n  }\n\n  get panels() {\n    return React.Children.toArray(this.props.children) as React.ReactElement[];\n  }\n\n  panelNodes: { [id: string]: HTMLDivElement | null } = {};\n\n  componentWillUnmount() {\n    const id = getNavId(this.props);\n    if (id) {\n      scrollsCache[id] = this.scrolls;\n    }\n    if (this.animationFinishTimeout) {\n      clearTimeout(this.animationFinishTimeout);\n    }\n  }\n\n  componentDidUpdate(prevProps: ViewInfiniteProps, prevState: ViewInfiniteState) {\n    this.props.popout && !prevProps.popout && this.blurActiveElement();\n    this.props.modal && !prevProps.modal && this.blurActiveElement();\n\n    // Нужен переход\n    if (\n      prevProps.activePanel !== this.props.activePanel &&\n      !prevState.swipingBack &&\n      !prevState.browserSwipe\n    ) {\n      let isBack = false;\n\n      if (this.props.isBackCheck) {\n        isBack = this.props.isBackCheck({\n          from: prevProps.activePanel,\n          to: this.props.activePanel,\n        });\n      } else {\n        const firstLayerId = this.panels\n          .map((panel) => getNavId(panel.props, warn))\n          .find((id) => id === prevProps.activePanel || id === this.props.activePanel);\n        isBack = firstLayerId === this.props.activePanel;\n      }\n\n      this.blurActiveElement();\n\n      const prevScrolls = this.scrolls[prevProps.activePanel] || [];\n      const scrolls = {\n        ...this.scrolls,\n        [prevProps.activePanel]: [...prevScrolls, this.props.scroll?.getScroll().y],\n      };\n      this.scrolls = scrolls;\n\n      if (this.shouldDisableTransitionMotion()) {\n        this.flushTransition(prevProps.activePanel, isBack);\n      } else {\n        this.setState({\n          visiblePanels: [prevProps.activePanel, this.props.activePanel],\n          prevPanel: prevProps.activePanel,\n          nextPanel: this.props.activePanel,\n          activePanel: null,\n          animated: true,\n          isBack,\n        });\n\n        // Фолбек анимации перехода\n        if (!animationEvent.supported) {\n          if (this.animationFinishTimeout) {\n            clearTimeout(this.animationFinishTimeout);\n          }\n          this.animationFinishTimeout = setTimeout(\n            this.transitionEndHandler,\n            this.props.platform === Platform.ANDROID || this.props.platform === Platform.VKCOM\n              ? 300\n              : 600,\n          );\n        }\n      }\n    }\n\n    // Закончилась анимация свайпа назад\n    if (prevProps.activePanel !== this.props.activePanel && prevState.swipingBack) {\n      const nextPanel = this.state.swipeBackNextPanel;\n      const prevPanel = this.state.swipeBackPrevPanel;\n      let scrollPosition: undefined | number = undefined;\n\n      this.scrolls = {\n        ...this.scrolls,\n      };\n\n      if (prevPanel !== null) {\n        const prevPanelScrolls = [...(this.scrolls[prevPanel] || [])].slice(0, -1);\n        this.scrolls[prevPanel] = prevPanelScrolls;\n      }\n      if (nextPanel !== null) {\n        const newPanelScrolls = [...(this.scrolls[nextPanel] || [])];\n        scrollPosition = newPanelScrolls.pop();\n        this.scrolls[nextPanel] = newPanelScrolls;\n      }\n\n      this.setState(\n        {\n          swipeBackPrevPanel: null,\n          swipeBackNextPanel: null,\n          swipingBack: false,\n          swipeBackResult: null,\n          swipeBackStartX: 0,\n          swipeBackShift: 0,\n          activePanel: nextPanel,\n          visiblePanels: [nextPanel],\n        },\n        () => {\n          this.props.scroll?.scrollTo(0, scrollPosition);\n          prevProps.onTransition &&\n            prevProps.onTransition({\n              isBack: true,\n              from: prevPanel,\n              to: nextPanel,\n            });\n        },\n      );\n    }\n\n    // Началась анимация завершения свайпа назад.\n    if (!prevState.swipeBackResult && this.state.swipeBackResult) {\n      this.waitTransitionFinish(\n        this.pickPanel(this.state.swipeBackNextPanel),\n        this.swipingBackTransitionEndHandler,\n      );\n    }\n\n    // Если свайп назад отменился (когда пользователь недостаточно сильно свайпнул)\n    if (\n      prevState.swipeBackResult === SwipeBackResults.fail &&\n      !this.state.swipeBackResult &&\n      this.state.activePanel !== null\n    ) {\n      const newPanelScrolls = [...(this.scrolls[this.state.activePanel] || [])];\n      const scrollPosition = newPanelScrolls.pop();\n      this.scrolls = {\n        ...this.scrolls,\n        [this.state.activePanel]: newPanelScrolls,\n      };\n\n      this.props.scroll?.scrollTo(0, scrollPosition);\n    }\n\n    // Закончился Safari свайп\n    if (prevProps.activePanel !== this.props.activePanel && this.state.browserSwipe) {\n      this.setState({\n        browserSwipe: false,\n        nextPanel: null,\n        prevPanel: null,\n        animated: false,\n        visiblePanels: [this.props.activePanel],\n        activePanel: this.props.activePanel,\n      });\n    }\n  }\n\n  shouldDisableTransitionMotion(): boolean {\n    return (\n      this.props.configProvider?.transitionMotionEnabled === false ||\n      !this.props.splitCol?.animate ||\n      this.props.platform === Platform.VKCOM\n    );\n  }\n\n  waitTransitionFinish(\n    elem: HTMLElement | null | undefined,\n    eventHandler: TransitionEventHandler,\n  ): void {\n    if (transitionEvent.supported && transitionEvent.name && elem) {\n      elem.removeEventListener(\n        transitionEvent.name as keyof HTMLElementEventMap,\n        eventHandler as EventListener,\n      );\n      elem.addEventListener(\n        transitionEvent.name as keyof HTMLElementEventMap,\n        eventHandler as EventListener,\n      );\n    } else {\n      if (this.transitionFinishTimeout) {\n        clearTimeout(this.transitionFinishTimeout);\n      }\n\n      this.transitionFinishTimeout = setTimeout(\n        eventHandler,\n        this.props.platform === Platform.ANDROID || this.props.platform === Platform.VKCOM\n          ? 300\n          : 600,\n      );\n    }\n  }\n\n  blurActiveElement(): void {\n    if (typeof this.window !== 'undefined' && this.document?.activeElement) {\n      (this.document.activeElement as HTMLElement).blur();\n    }\n  }\n\n  pickPanel(id: string | null) {\n    if (id === null) {\n      return undefined;\n    }\n    return this.panelNodes[id];\n  }\n\n  flushTransition(prevPanel: string, isBack: boolean) {\n    const activePanel = this.props.activePanel;\n\n    const prevPanelScrolls = [...(this.scrolls[prevPanel] || [])].slice(0, -1);\n    const newPanelScrolls = [...(this.scrolls[activePanel] || [])];\n    const scrollPosition = isBack ? newPanelScrolls.pop() : 0;\n    if (isBack) {\n      this.scrolls = {\n        ...this.scrolls,\n        [prevPanel]: prevPanelScrolls,\n        [activePanel]: newPanelScrolls,\n      };\n    }\n\n    this.setState(\n      {\n        prevPanel: null,\n        nextPanel: null,\n        visiblePanels: [activePanel],\n        activePanel: activePanel,\n        animated: false,\n        isBack: undefined,\n      },\n      () => {\n        this.props.scroll?.scrollTo(0, isBack ? scrollPosition : 0);\n        this.props.onTransition &&\n          this.props.onTransition({ isBack, from: prevPanel, to: activePanel });\n      },\n    );\n  }\n\n  transitionEndHandler = (e?: React.AnimationEvent): void => {\n    if (\n      (!e ||\n        [\n          'vkui-animation-ios-next-forward',\n          'vkui-animation-ios-prev-back',\n          'vkui-animation-view-next-forward',\n          'vkui-animation-view-prev-back',\n        ].includes(e.animationName)) &&\n      this.state.prevPanel !== null\n    ) {\n      this.flushTransition(this.state.prevPanel, Boolean(this.state.isBack));\n    }\n  };\n\n  swipingBackTransitionEndHandler = (e?: TransitionEvent): void => {\n    // indexOf because of vendor prefixes in old browsers\n    if (\n      !e ||\n      (e.propertyName.includes('transform') &&\n        e.target === this.pickPanel(this.state.swipeBackNextPanel))\n    ) {\n      switch (this.state.swipeBackResult) {\n        case SwipeBackResults.fail:\n          this.onSwipeBackCancel();\n          break;\n        case SwipeBackResults.success:\n          this.onSwipeBackSuccess();\n      }\n    }\n  };\n\n  onSwipeBackSuccess(): void {\n    this.props.onSwipeBack && this.props.onSwipeBack();\n  }\n\n  onSwipeBackCancel(): void {\n    this.props.onSwipeBackCancel && this.props.onSwipeBackCancel();\n    this.setState({\n      swipeBackPrevPanel: null,\n      swipeBackNextPanel: null,\n      swipingBack: false,\n      swipeBackResult: null,\n      swipeBackStartX: 0,\n      swipeBackShift: 0,\n    });\n  }\n\n  onMoveX = (event: TouchEvent): void => {\n    if (\n      !this.window ||\n      this.props.platform !== Platform.IOS ||\n      this.state.swipeBackPrevented ||\n      swipeBackExcluded(event) ||\n      this.shouldDisableTransitionMotion()\n    ) {\n      return;\n    }\n\n    if (!this.props.configProvider?.isWebView) {\n      if (\n        (event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA ||\n          event.startX >= this.window.innerWidth - ViewInfiniteComponent.SWIPE_BACK_AREA) &&\n        !this.state.browserSwipe\n      ) {\n        this.setState({ browserSwipe: true });\n      }\n\n      return;\n    }\n\n    if (\n      !this.props.onSwipeBack ||\n      (this.state.animated && event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA)\n    ) {\n      return;\n    }\n\n    if (\n      !this.state.swipingBack &&\n      event.startX <= ViewInfiniteComponent.SWIPE_BACK_AREA &&\n      this.props.history &&\n      this.props.history.length > 1\n    ) {\n      if (this.props.onSwipeBackStart) {\n        const payload = this.props.onSwipeBackStart(this.state.activePanel);\n        if (payload === 'prevent') {\n          this.setState({ swipeBackPrevented: true });\n          return;\n        }\n      }\n\n      if (this.state.activePanel !== null) {\n        // Note: вызываем закрытие клавиатуры. В iOS это нативное поведение при свайпе.\n        this.blurActiveElement();\n        const prevScrolls = this.scrolls[this.state.activePanel] || [];\n        this.scrolls = {\n          ...this.scrolls,\n          [this.state.activePanel]: [...prevScrolls, this.props.scroll?.getScroll().y],\n        };\n      }\n\n      this.setState({\n        swipingBack: true,\n        swipeBackStartX: event.startX,\n        swipeBackPrevPanel: this.state.activePanel,\n        swipeBackNextPanel: this.props.history.slice(-2)[0],\n      });\n    }\n\n    if (this.state.swipingBack) {\n      let swipeBackShift;\n      if (event.shiftX < 0) {\n        swipeBackShift = 0;\n      } else if (event.shiftX > this.window.innerWidth - this.state.swipeBackStartX) {\n        swipeBackShift = this.window.innerWidth;\n      } else {\n        swipeBackShift = event.shiftX;\n      }\n      this.setState({ swipeBackShift });\n    }\n  };\n\n  onEnd = (event: TouchEvent): void => {\n    if (this.state.swipingBack && this.window) {\n      const speed = (this.state.swipeBackShift / event.duration) * 1000;\n      if (this.state.swipeBackShift === 0) {\n        this.onSwipeBackCancel();\n      } else if (this.state.swipeBackShift >= this.window.innerWidth) {\n        this.onSwipeBackSuccess();\n      } else if (\n        speed > 250 ||\n        this.state.swipeBackStartX + this.state.swipeBackShift > this.window.innerWidth / 2\n      ) {\n        this.setState({ swipeBackResult: SwipeBackResults.success });\n      } else {\n        this.setState({ swipeBackResult: SwipeBackResults.fail });\n      }\n    }\n    if (this.state.swipeBackPrevented) {\n      this.setState({ swipeBackPrevented: false });\n    }\n  };\n\n  calcPanelSwipeStyles(panelId: string | undefined): React.CSSProperties {\n    if (!canUseDOM || !this.window) {\n      return {};\n    }\n\n    const isPrev = panelId === this.state.swipeBackPrevPanel;\n    const isNext = panelId === this.state.swipeBackNextPanel;\n\n    if ((!isPrev && !isNext) || this.state.swipeBackResult) {\n      return {};\n    }\n\n    let prevPanelTranslate = `${this.state.swipeBackShift}px`;\n    let nextPanelTranslate = `${\n      -50 + (this.state.swipeBackShift * 100) / this.window.innerWidth / 2\n    }%`;\n    let prevPanelShadow =\n      (0.3 * (this.window.innerWidth - this.state.swipeBackShift)) / this.window.innerWidth;\n\n    if (this.state.swipeBackResult) {\n      return isPrev ? { boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})` } : {};\n    }\n\n    if (isNext) {\n      return {\n        transform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${nextPanelTranslate}, 0, 0)`,\n      };\n    }\n    if (isPrev) {\n      return {\n        transform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        WebkitTransform: `translate3d(${prevPanelTranslate}, 0, 0)`,\n        boxShadow: `-2px 0 12px rgba(0, 0, 0, ${prevPanelShadow})`,\n      };\n    }\n\n    return {};\n  }\n\n  render() {\n    const {\n      popout,\n      modal,\n      platform,\n      activePanel: _1,\n      splitCol,\n      configProvider,\n      history,\n      id,\n      nav,\n      onTransition,\n      onSwipeBack,\n      onSwipeBackStart,\n      onSwipeBackCancel,\n      window,\n      document,\n      scroll,\n      isBackCheck,\n      className,\n      ...restProps\n    } = this.props;\n    const {\n      prevPanel,\n      nextPanel,\n      activePanel,\n      isBack,\n      animated,\n      swipeBackPrevPanel,\n      swipeBackNextPanel,\n      swipeBackResult,\n      swipingBack,\n    } = this.state;\n\n    const hasPopout = !!popout;\n    const hasModal = !!modal;\n\n    const panels = this.panels\n      .filter((panel) => {\n        const panelId = getNavId(panel.props, warn);\n\n        return (\n          (panelId !== undefined && this.state.visiblePanels.includes(panelId)) ||\n          panelId === swipeBackPrevPanel ||\n          panelId === swipeBackNextPanel\n        );\n      })\n      .sort((panel) => {\n        const panelId = getNavId(panel.props, warn);\n        const isPrevPanel = panelId === prevPanel || panelId === swipeBackPrevPanel;\n        const isNextPanel = panelId === nextPanel || panelId === swipeBackNextPanel;\n\n        if (isNextPanel) {\n          return swipingBack || this.state.isBack ? -1 : 1;\n        }\n\n        if (isPrevPanel) {\n          return swipingBack || this.state.isBack ? 1 : -1;\n        }\n\n        return 0;\n      });\n\n    const disableAnimation = this.shouldDisableTransitionMotion();\n\n    return (\n      <Touch\n        Component=\"section\"\n        {...restProps}\n        className={classNames(\n          styles['View'],\n          getPlatformClassName(styles['View'], platform),\n          !disableAnimation && this.state.animated && styles['View--animated'],\n          !disableAnimation && this.state.swipingBack && styles['View--swiping-back'],\n          disableAnimation && styles['View--no-motion'],\n          className,\n        )}\n        onMoveX={this.onMoveX}\n        onEnd={this.onEnd}\n      >\n        <div className={styles['View__panels']}>\n          {panels.map((panel: React.ReactElement) => {\n            const panelId = getNavId(panel.props, warn);\n            const isPrev = panelId === prevPanel || panelId === swipeBackPrevPanel;\n            const compensateScroll =\n              isPrev || panelId === swipeBackNextPanel || (panelId === nextPanel && isBack);\n            const isTransitionTarget = animated && panelId === (isBack ? prevPanel : nextPanel);\n            const scrollList = (panelId && this.scrolls[panelId]) || [];\n            const scroll = scrollList[scrollList.length - 1] || 0;\n\n            return (\n              <div\n                className={classNames(\n                  styles['View__panel'],\n                  panelId === activePanel && iosStyles['View__panel--active'],\n                  panelId === prevPanel && styles['View__panel--prev'],\n                  panelId === nextPanel && styles['View__panel--next'],\n                  panelId === swipeBackPrevPanel && iosStyles['View__panel--swipe-back-prev'],\n                  panelId === swipeBackNextPanel && iosStyles['View__panel--swipe-back-next'],\n                  swipeBackResult === SwipeBackResults.success &&\n                    iosStyles['View__panel--swipe-back-success'],\n                  swipeBackResult === SwipeBackResults.fail &&\n                    iosStyles['View__panel--swipe-back-failed'],\n                )}\n                onAnimationEnd={isTransitionTarget ? this.transitionEndHandler : undefined}\n                ref={(el) => panelId !== undefined && (this.panelNodes[panelId] = el)}\n                style={this.calcPanelSwipeStyles(panelId)}\n                key={panelId}\n              >\n                <div\n                  className={styles['View__panel-in']}\n                  style={{ marginTop: compensateScroll ? -scroll : undefined }}\n                >\n                  <NavTransitionProvider\n                    entering={panelId === nextPanel || panelId === swipeBackNextPanel}\n                  >\n                    {panel}\n                  </NavTransitionProvider>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        <AppRootPortal>\n          {hasPopout && <div className={styles['View__popout']}>{popout}</div>}\n          {hasModal && <div className={styles['View__modal']}>{modal}</div>}\n        </AppRootPortal>\n      </Touch>\n    );\n  }\n}\n\nexport const ViewInfinite = withContext(\n  withContext(\n    withContext(\n      withPlatform(withDOM<ViewInfiniteProps>(ViewInfiniteComponent)),\n      SplitColContext,\n      'splitCol',\n    ),\n    ConfigProviderContext,\n    'configProvider',\n  ),\n  ScrollContext,\n  'scroll',\n);\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}